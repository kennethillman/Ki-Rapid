/*
RAPID - Drag and drop
*/(function(e,t){window.RAPID=window.RAPID||{};var n=t(".header-org,.content-org,.footer-org"),r=t(".header-org"),i=t(".content-org"),s=t(".footer-org"),o=t(".added-row"),u=t(".added-module"),a=null;RAPID.init=function(){console.log("RAPID.init")};RAPID.jsEqualHeights=function(){t(".js-section-template").each(function(){t("p",this).css("height","auto").setAllToMaxHeight()})};RAPID.childCount=function(){t(".js-section-template .js-container").each(function(){var e=t(this),n=e.children().size();e.parent().addClass("RAPID-count-"+n)})};RAPID.init=function(){console.log("RAPID.init")};RAPID.bthEdit=function(){console.log("RAPID.bthEdit");t(".bth-edit").on("click",function(e){var n=t(this),r=t("body");if(r.hasClass("edit-layout")){r.removeClass("edit-layout");RAPID.removeDropAreas()}else{r.addClass("edit-layout");RAPID.addDropAreas();RAPID.drop.init()}return!1})};RAPID.addDropAreas=function(){console.log("RAPID.addDropAreas");n.addClass("drop-here");n.find(".big").text("Drop area")};RAPID.removeDropAreas=function(){console.log("RAPID.removeDropAreas");n.parent().removeClass("drop-here");r.find(".big").text("Header");i.find(".big").text("Content");s.find(".big").text("Footer");t(".ghost-row").remove();t(".ghost-module").remove()};RAPID.drag={init:function(){console.log("RAPID.drag.init();");RAPID.drag.addListners()},handleDragStart:function(e){console.log("RAPID.drag.handleDragStart();");a=this;e.dataTransfer.effectAllowed="copy";e.dataTransfer.setData("text/html",this.innerHTML)},handleDragEnd:function(t){console.log("RAPID.drag.handleDragEnd();");var n=e.querySelectorAll(".drop-here");[].forEach.call(n,function(e){e.classList.remove("dragOVER");e.classList.remove("dragLEAVE")})},addListners:function(){console.log("RAPID.drag.addListners();");var t=e.querySelectorAll(".drag-me");[].forEach.call(t,function(e){e.setAttribute("draggable","true");e.addEventListener("dragstart",RAPID.drag.handleDragStart,!1);e.addEventListener("dragend",RAPID.drag.handleDragEnd,!1)})}};RAPID.drop={init:function(){console.log("init -> RAPID.drop.init();");RAPID.drop.dropAreas()},dropAreas:function(e){t(".ghost-row").remove();t(".ghost-module").remove();t(".added-row").parent().removeClass("drop-here");t(".added-row").before('<div class="ghost-row drop-here before">Drop area</div>');t(".added-module").addClass("drop-here");t(".added-module").before('<div class="ghost-module drop-here before">Drop area</div>');RAPID.drop.addListners()},handleDragEnter:function(e){this.classList.add("dragENTER");this.classList.remove("dragLEAVE")},handleDragOver:function(e){e.preventDefault&&e.preventDefault();e.dataTransfer.dropEffect="copy";this.classList.add("dragOVER");this.classList.remove("dragLEAVE");return!1},handleDrop:function(e){e.stopPropagation&&e.stopPropagation();this.classList.remove("over");this.classList.remove("dragOVER");this.classList.remove("dragENTER");this.classList.remove("dragLEAVE");var n=e.dataTransfer.getData("text/html");t(this).replaceWith(n);RAPID.drop.dropAreas();return!1},handleDragLeave:function(e){this.classList.add("dragLEAVE");this.classList.remove("dragENTER");this.classList.remove("dragOVER")},addListners:function(){console.log("RAPID.drop.addListners();");var t=e.querySelectorAll(".drop-here");[].forEach.call(t,function(e){e.addEventListener("dragenter",RAPID.drop.handleDragEnter,!1);e.addEventListener("dragover",RAPID.drop.handleDragOver,!1);e.addEventListener("drop",RAPID.drop.handleDrop,!1);e.addEventListener("dragleave",RAPID.drop.handleDragLeave,!1)})}};t(window).on("load",function(){});t(e).on("ready",function(){});t(e).on("scroll",function(){})})(document,jQuery);